/* minimodal v. 0.8.0 */
!function(a){function b(b,c){var d=f(a(b).data("mimo"));if(this.options=a.extend({},e,d,c),this.options.close="."+this.options.close.replace(/["'\.]/g,""),this.options.top=Number(this.options.top),!this.options.modal)throw"Cannot start minimodal without modal attribute in options";this.element=b,this.$modal=a("#"+this.options.modal.replace("#","")),this.$modal.addClass(this.options.skin),this.init()}var c="mimo",d="plugin_"+c,e={top:100,width:520,opacity:.3,close:".mimo_close",background:"#mimo_bg",onAfterOpen:function(){}},f=function(b){if("string"==typeof b){for(var c=b.split(";"),d={},e=0;e<c.length;e++){var f=c[e],g=f.split(":");g&&(g[0]=a.trim(g[0]),g[1]=a.trim(g[1]),""!==g[0]&&""!==g[1]&&(d[g[0]]=g[1]))}return d}},g=function(b,c){if(a(b).attr("data-mimo-src")){var d=new Image,e=a(b),f=e.attr("data-mimo-src");d.src=f,e.css({opacity:0}),a(d).on("load",function(){e.attr("src",f).animate({opacity:1}),"function"==typeof c&&c()}),d.complete&&a(d).trigger("load")}};a.extend(b.prototype,{init:function(){var b=this;this.onClick=function(c){b.openModal(),a(b.options.close+", "+b.options.background).on("click",b.onClickClose),c.preventDefault()},this.onClickClose=function(c){b.closeModal(),a(b.options.close+", "+b.options.background).off("click",b.onClickClose),c.preventDefault()},this.onResize=function(){a(window).width()!=b.windowWidth&&(b.windowWidth=a(window).width(),b.centerModal())},this.onKeydown=function(a){27===a.keyCode&&b.closeModal()},a(this.element).on("click",this.onClick),a(window).on("resize",this.onResize),a(document).on("keydown",this.onKeydown),$closeButton=this.$modal.find(this.options.close),$closeButton.length||(a("<div class="+e.close.replace(/\./,"")+">&#x2715;</div>").prependTo(this.$modal),this.options.close=e.close)},destroy:function(){a(this.element).off("click",this.onClick),a(window).off("resize",this.onResize),a(document).off("keydown",this.onKeydown)},openModal:function(){var b=this;a(this.options.background).length||a("body").append(a("<div></div>").attr("id",this.options.background.replace(/#/g,""))),a(this.options.background).css({backgroundColor:this.options.overlay}).fadeTo(250,this.options.opacity),this.$modal.css({maxWidth:Number(this.options.width)}).fadeTo(250,1),this.centerModal(),this.$modal.find("img").each(function(){g(this,function(){b.centerModal()})}),"function"==typeof this.options.onAfterOpen&&this.options.onAfterOpen()},closeModal:function(){a(this.options.background).hide(),this.$modal.hide(),a(this.options.background).css({backgroundColor:""})},centerModal:function(){this.$modal.css({left:0});var b=this.$modal.outerWidth(!0),c=this.$modal.outerHeight(!0),d=a(window).outerWidth(!0),e=a(window).outerHeight(!0),f=(d-b)/2|0,g=(e-c)/2|0;f=0>f?0:f,g=0>g?0:g>this.options.top?g=this.options.top:g,g+=a(window).scrollTop(),this.$modal.css({left:Number(f),top:Number(g)})}}),a.fn[c]=function(c){return this.each(function(){a.data(this,d)&&a.data(this,d).destroy(),a.data(this,d,new b(this,c))})},a(function(){a("[data-mimo]").each(function(){a(this).mimo()})})}(jQuery);