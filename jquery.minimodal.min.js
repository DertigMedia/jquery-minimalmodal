!function(a){function b(b,c){this.$modal=a("#"+a(b).attr("href").replace("#",""));var d=f(this.$modal.data("mimo"));this.options=a.extend({},e,d,c),this.options.close="."+this.options.close.replace(/["'\.]/g,""),this.element=b,this.init()}var c="minimodal",d="plugin_"+c,e={opacity:.4,color:"#000",top:100,width:520,selector:".mimo_open",close:".mimo_close",modal:".mimo_modal",background:"#mimo_bg"},f=function(b){if("string"==typeof b){for(var c=b.split(";"),d={},e=0;e<c.length;e++){var f=c[e],g=f.split(":");g&&(g[0]=a.trim(g[0]),g[1]=a.trim(g[1]),""!==g[0]&&""!==g[1]&&(d[g[0]]=g[1]))}return d}};a.extend(b.prototype,{init:function(){var b=this;this.onClick=function(c){b.openModal(),a(b.options.close+", "+b.options.background).on("click",b.onClickClose),c.preventDefault()},this.onClickClose=function(c){b.closeModal(),a(b.options.close+", "+b.options.background).off("click",b.onClickClose),c.preventDefault()},a(this.element).on("click",this.onClick),$closeButton=this.$modal.find(this.options.close),$closeButton.length||(a("<div class="+e.close.replace(/\./,"")+">&#10799;</div>").prependTo(this.$modal),this.options.close=e.close)},destroy:function(){a(this.element).off("click",this.onClick)},openModal:function(){a(this.options.background).length||a("body").append(a("<div></div>").attr("id",this.options.background.replace(/#/g,""))),a(this.options.background).css({backgroundColor:this.options.color}).fadeTo(250,this.options.opacity),this.$modal.css({maxWidth:Number(this.options.width)}).fadeTo(250,1),this.centerModal()},closeModal:function(){a(this.options.background+", "+this.options.modal).hide()},centerModal:function(){var b=this.$modal.outerWidth(!0),c=this.$modal.outerHeight(!0),d=a(window).width(),e=a(window).height(),f=(d-b)/2,g=(e-c)/2;b<this.options.width&&(f=0),f=0>f?0:f,g=0>g?0:g>this.options.top?g=this.options.top:g,g+=a(window).scrollTop(),this.$modal.css({left:f,top:g})}}),a.fn[c]=function(c){return this.each(function(){a.data(this,d)&&a.data(this,d).destroy(),a.data(this,d,new b(this,c))})},a(window).on("resize",function(){setTimeout(function(){a(e.selector).each(function(){a.data(this,d).centerModal()})},0)}),a(document).on("keydown",function(b){27===b.keyCode&&a(e.selector).each(function(){a.data(this,d).closeModal()})}),a(e.selector).each(function(){a(this).minimodal()})}(jQuery);